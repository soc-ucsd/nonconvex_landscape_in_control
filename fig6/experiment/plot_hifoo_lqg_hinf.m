% clear all; close all; clc;
% %%
% 
% % A = [1 1;1 0]; B2 = [0;1]; C2 = [1 -1];
% A = [0 -1;1 0]; B2 = [1;0]; C2 = [1 -1];
% 
% [nx, nu] = size(B2);
% [ny, ~] = size(C2);
% 
% nw = nx + ny;
% nz = nx + nu;
% 
% % W = [1 0;0 3]; %[2 1;1 2];
% % V = 1;
% % Q = [1 0;0 1];
% % R = 1;
% W = [1 -1;-1 16]; %[2 1;1 2];
% V = 1;
% Q = [4 0;0 0];
% R = 1;
% 
% B1 = [W^0.5 zeros(nx, ny)];
% C1 = [Q^0.5; zeros(nu, nx)];
% D11 = zeros(nz, nw);
% D12 = [zeros(nx, nu); R^0.5];
% D21 = [zeros(ny, nx) V^0.5];
% 
% %% HIFOO
% sys_struct = struct;
% sys_struct.A = A; sys_struct.B1 = B1; sys_struct.B2 = B2; 
% sys_struct.C1 = C1; sys_struct.C2 = C2; 
% sys_struct.D11 = D11; sys_struct.D12 = D12; sys_struct.D21 = D21;
% options.prtlevel = 3;
% [K_hifoo, J_hifoo] = hifoo(sys_struct, nx, 't',options);

%%
cost_lqg = [23.5924 17.892 15.6747 14.0576 12.4893 6.95079 6.4744 6.34666 6.33749 6.33726 6.33717 6.33662...
    6.33145 6.25234 6.19614 6.19321 6.19156 6.19129 6.19127 6.19127 6.19126 6.19117 6.18981 6.18418...
    6.17892 6.17749 6.17648 6.17548 6.17497 6.17452 6.17427 6.17411 6.17405 6.17402 6.17402 6.17401...
    6.17401 6.17401 6.17401 6.17401 6.17401 6.17397 6.17367 6.17265 6.17246 6.16819 6.16627 6.16496...
    6.16458 6.16444 6.16442 6.16441 6.16441];

cost_hinf = [11.5298,7.97833 7.53177 7.51441 7.22728 6.36603 5.76119 5.72753 5.70536 5.70238 5.70215 5.69092 5.65882 5.62727 5.62326...
    5.61352 5.60317 5.57423 5.56123 5.55726 5.55418 5.55141 5.54436 5.53024 5.5287 5.52851 5.52752 5.52543 5.5211 5.51764...
    5.51282 5.51041 5.51039 5.50876 5.50699 5.50593 5.50427 5.50271 5.49676 5.49505 5.49416 5.49272 5.49235 5.4893 5.48913 5.48908...
    5.4875 5.48728 5.48696 5.48655 5.48642 5.48639 5.48639 5.48606 5.4858 5.48549 5.4853 5.48503 5.48498 5.48492 5.48489 5.48487 5.48481...
    5.48467 5.48467 5.48335 5.48268 5.48074 5.47765 5.47703 5.47525 5.47493 5.47331 5.47316 5.47221 5.47162 5.4716 5.46973 5.46934 5.46894...
    5.46841 5.46776 5.46623 5.46462 5.46294 5.46293 5.4623 5.4613 5.46101 5.4608 5.46063 5.45968 5.45806 5.45752 5.45693 5.45688 5.45624 5.45609...
    5.45587 5.45583 5.45568 5.45543 5.455 5.45419 5.45229 5.45032 5.44705 5.44641 5.44596 5.44535 5.44532 5.44438 5.44371 5.44227 5.44207 5.44072...
    5.43943 5.438 5.43768 5.43753 5.43718 5.43717 5.43691 5.43657 5.43628 5.43614 5.43476 5.43462 5.4342 5.43408 5.43407 5.43398 5.43394 5.43365 5.43364...
    5.43329 5.43303 5.43257 5.43236 5.43208 5.43185 5.43144 5.4313 5.43115 5.43104 5.43099 5.43091 5.43091 5.43082 5.43081 5.43079 5.43072 5.43067 5.43054...
    5.43054 5.43051 5.43051 5.43051 5.43051 5.4305 5.4305 5.43048 5.43048 5.43047 5.43044 5.43036 5.43031 5.43023 5.4302 5.43013 5.43006 5.42865 5.42838 5.4278...
    5.42764 5.42741 5.42741 5.42738 5.42737 5.42733 5.42685 5.42676 5.42644 5.42642 5.42638 5.42638 5.42634 5.42633 5.42633 5.42632 5.4263 5.4263 5.42628 5.42627...
    5.42626 5.42626 5.42626 5.42625 5.42625 5.42625 5.42625 5.42625 5.42625 5.42624 5.42624 5.42624 5.42624 5.42624 5.42624 5.42624...
    5.42624 5.42624 5.42624 5.42624 5.42623 5.42623 5.42622 5.42622 5.42622 5.42622 5.42618...
    5.42618 5.42615 5.42614 5.42614 5.42614 5.42612 5.42611 5.4261 5.4261 5.4261 5.42609 5.42606 5.42606 5.42606 5.42605 5.42604 5.42604 5.42604 5.42603...
    5.42603 5.42603 5.42603 5.42603 5.42603 5.42603 5.42602 5.42601 5.42601 5.42601 5.42601 5.426 5.426];


figure();
plot(1:length(cost),cost_lqg-6.16441,1:length(cost_hinf),cost_hinf-5.426,'-','LineWidth',3);
set(gca, 'YScale', 'log')
legend('LQG','$\mathcal{H}_\infty$','Interpreter','latex');

xlabel('Iterations','FontSize',20,'Interpreter','latex')
ylabel('Suboptimality','FontSize',20,'Interpreter','latex');
% grid on



set(gca,'FontSize',20)